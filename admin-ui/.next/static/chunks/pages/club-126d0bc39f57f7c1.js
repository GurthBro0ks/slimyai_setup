(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[0],{1653:function(e,l,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/club",function(){return a(9400)}])},9400:function(e,l,a){"use strict";a.r(l),a.d(l,{default:function(){return o}});var t=a(5893),i=a(7294),s=a(1163),n=a(5754),r=a(7751),d=a(2608);function o(){let{user:e,loading:l}=(0,d.k)(),a=(0,s.useRouter)(),[o,c]=(0,i.useState)([]),[m,h]=(0,i.useState)(null),[p,v]=(0,i.useState)(null),[g,f]=(0,i.useState)(null),[y,x]=(0,i.useState)(null);(0,i.useEffect)(()=>{var t;!l&&e&&((null===(t=e.guilds)||void 0===t?void 0:t.some(e=>"club"===e.role||"admin"===e.role))||a.replace("/snail"))},[l,e,a]),(0,i.useEffect)(()=>{!l&&e&&(0,r.SC)("/api/guilds").then(e=>{var l;let t=Array.isArray(null==e?void 0:e.guilds)?e.guilds:[];c(t);let i=a.query.guildId||(null===(l=t[0])||void 0===l?void 0:l.id)||null;i&&h(String(i))}).catch(e=>x(e.message||"Failed to load guilds"))},[l,e,a.query.guildId]),(0,i.useEffect)(()=>{if(!m){v(null),f(null);return}x(null),(0,r.SC)("/api/guilds/".concat(m,"/health")).then(e=>v(e)).catch(e=>x(e.message||"Failed to load club health")),(0,r.SC)("/api/guilds/".concat(m,"/snail/stats")).then(e=>f((null==e?void 0:e.record)||null)).catch(()=>f(null))},[m]);let j=(0,i.useMemo)(()=>o.map(e=>({value:e.id,label:e.name})),[o]);return l||!e?(0,t.jsx)(n.Z,{title:"Club Dashboard",guildId:m||void 0,children:(0,t.jsx)("div",{className:"card",style:{padding:"1.25rem"},children:"Loading…"})}):(0,t.jsxs)(n.Z,{title:"Club Dashboard",guildId:m||void 0,children:[y&&(0,t.jsx)("div",{className:"card",style:{padding:"1rem",marginBottom:"1rem",color:"#f87171"},children:y}),(0,t.jsxs)("div",{className:"card",style:{marginBottom:"1.5rem",display:"flex",flexWrap:"wrap",gap:"1rem",alignItems:"center"},children:[(0,t.jsx)("h2",{style:{margin:0,fontSize:"1.4rem"},children:"Club Overview"}),(0,t.jsx)("div",{children:(0,t.jsx)("select",{className:"select",value:m||"",onChange:e=>{let l=e.target.value;h(l),a.replace({pathname:"/club",query:{guildId:l}},void 0,{shallow:!0})},children:j.map(e=>(0,t.jsx)("option",{value:e.value,children:e.label},e.value))})}),(0,t.jsx)("a",{className:"btn outline",href:m?"/snail/".concat(m):"/snail",children:"\uD83D\uDC0C Snail Tools"})]}),p&&(0,t.jsxs)("div",{className:"grid",style:{gap:"1rem",marginBottom:"1.5rem"},children:[(0,t.jsx)(u,{title:"Members",value:p.members}),(0,t.jsx)(u,{title:"Total Power",value:p.totalPower}),(0,t.jsx)(u,{title:"SIM Power",value:p.simPower}),(0,t.jsx)(u,{title:"Last Snapshot",value:p.lastSnapshotAt||"—"})]}),g?(0,t.jsxs)("div",{className:"card",style:{display:"grid",gap:"0.75rem"},children:[(0,t.jsx)("h3",{style:{marginTop:0},children:"Latest Snail Snapshot"}),(0,t.jsxs)("div",{style:{fontSize:"0.9rem",opacity:.75},children:["Captured ",new Date(g.uploadedAt).toLocaleString()," – prompt: ",g.prompt||"Default"]}),(0,t.jsx)("div",{className:"grid",style:{gap:"0.75rem"},children:(g.results||[]).map(e=>{var l,a,i;return(0,t.jsxs)("div",{className:"card",style:{padding:"0.9rem"},children:[(0,t.jsx)("div",{style:{fontWeight:600,marginBottom:4},children:(null===(l=e.file)||void 0===l?void 0:l.name)||"Screenshot"}),(0,t.jsxs)("div",{style:{fontSize:"0.85rem",opacity:.75},children:["Uploaded by ",(null===(a=e.uploadedBy)||void 0===a?void 0:a.name)||"unknown"]})]},null===(i=e.file)||void 0===i?void 0:i.storedAs)})})]}):(0,t.jsxs)("div",{className:"card",style:{padding:"1.25rem"},children:[(0,t.jsx)("h3",{style:{marginTop:0},children:"No Snail stats yet"}),(0,t.jsx)("p",{style:{margin:0,opacity:.75},children:"Run an analysis in Snail Tools to populate this panel."})]})]})}function u(e){let{title:l,value:a}=e;return(0,t.jsxs)("div",{className:"card",style:{padding:"1rem"},children:[(0,t.jsx)("div",{style:{opacity:.65,fontSize:"0.85rem"},children:l}),(0,t.jsx)("div",{style:{fontSize:"1.6rem",fontWeight:700},children:function(e){if(null==e)return"—";let l=Number(e);return Number.isNaN(l)?String(e):l.toLocaleString()}(a)})]})}}},function(e){e.O(0,[359,754,888,774,179],function(){return e(e.s=1653)}),_N_E=e.O()}]);