(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[759],{3617:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/guilds/[guildId]/personality",function(){return n(2614)}])},4166:function(e,t,n){"use strict";n.d(t,{Z:function(){return d}});var a=n(4246),s=n(9894),i=n.n(s),l=n(6677),r=n(7378),o=n(6e3),c=n(5682);let u=[{href:e=>"/guilds/".concat(e),label:"Dashboard"},{href:e=>"/guilds/".concat(e,"/settings"),label:"Club Settings"},{href:e=>"/guilds/".concat(e,"/channels"),label:"Channels"},{href:e=>"/guilds/".concat(e,"/personality"),label:"Personality"},{href:e=>"/guilds/".concat(e,"/corrections"),label:"Corrections"},{href:e=>"/guilds/".concat(e,"/rescan"),label:"Rescan User"},{href:e=>"/guilds/".concat(e,"/usage"),label:"Usage"}];function d(e){var t;let{guildId:n,children:s,title:d}=e,h=(0,l.useRouter)(),p=(0,c.h)(),{user:f,refresh:g}=(0,o.k)(),y=(0,r.useMemo)(()=>n?u.map(e=>{let t=e.href(n);return{...e,href:t,active:h.pathname===t}}):[],[n,h.asPath]);return(0,a.jsxs)("div",{className:"layout",children:[(0,a.jsxs)("aside",{className:"sidebar",children:[(0,a.jsxs)("div",{style:{marginBottom:32},children:[(0,a.jsx)("h1",{style:{margin:0,fontSize:22,fontWeight:700},children:"Slimy Admin"}),f&&(0,a.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[(0,a.jsxs)("span",{style:{opacity:.8,fontSize:14},children:[f.username," \xb7 ",null===(t=f.role)||void 0===t?void 0:t.toUpperCase()]}),(0,a.jsx)("button",{className:"btn outline",onClick:async()=>{try{await p("/api/auth/logout",{method:"POST"}),await g()}catch(e){console.error(e)}},children:"Logout"})]})]}),n?(0,a.jsx)("nav",{style:{display:"flex",flexDirection:"column",gap:8},children:y.map(e=>(0,a.jsx)(i(),{href:e.href,legacyBehavior:!0,children:(0,a.jsx)("a",{style:{padding:"10px 12px",borderRadius:8,background:h.asPath===e.href?"rgba(56, 189, 248, 0.15)":"transparent",border:h.asPath===e.href?"1px solid rgba(56, 189, 248, 0.4)":"1px solid transparent"},children:e.label})},e.href))}):(0,a.jsx)("p",{style:{opacity:.7},children:"Select a guild to begin."})]}),(0,a.jsxs)("main",{className:"content",children:[d&&(0,a.jsx)("h2",{style:{marginTop:0,marginBottom:24},children:d}),s]})]})}},5682:function(e,t,n){"use strict";n.d(t,{S:function(){return i},h:function(){return l}});var a=n(7378),s=n(6e3);async function i(e){let{method:t="GET",body:n,csrfToken:a}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=new Headers;!n||n instanceof FormData||s.set("Content-Type","application/json"),a&&t&&"GET"!==t&&s.set("x-csrf-token",a);let i=await fetch("".concat("http://localhost:3080").concat(e),{method:t,body:n?n instanceof FormData?n:JSON.stringify(n):void 0,credentials:"include",headers:s});if(204===i.status)return null;let l=(i.headers.get("content-type")||"").includes("application/json")?await i.json():await i.text();if(!i.ok)throw Error((null==l?void 0:l.error)||(null==l?void 0:l.message)||"HTTP ".concat(i.status));return l}function l(){let{csrfToken:e}=(0,s.k)();return(0,a.useCallback)(function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return i(t,{...n,csrfToken:e})},[e])}},2614:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return u}});var a=n(4246),s=n(7378),i=n(6677),l=n(9720),r=n(4166),o=n(5682);let c=e=>(0,o.S)(e);function u(){let{guildId:e}=(0,i.useRouter)().query,t=(0,o.h)(),{data:n,mutate:u}=(0,l.ZP)(e?"/api/guilds/".concat(e,"/personality"):null,c),[d,h]=(0,s.useState)("{}"),[p,f]=(0,s.useState)(null);(0,s.useEffect)(()=>{(null==n?void 0:n.profile)&&h(JSON.stringify(n.profile,null,2))},[n]);let g=async()=>{f("Savingâ€¦");try{let n=d?JSON.parse(d):{},a=await t("/api/guilds/".concat(e,"/personality"),{method:"PUT",body:{profile:n}});await u(a,{revalidate:!1}),f("Saved")}catch(e){f(e.message)}};return(0,a.jsx)(r.Z,{guildId:e,title:"Persona Overrides",children:(0,a.jsxs)("div",{className:"card",style:{maxWidth:720},children:[(0,a.jsx)("p",{style:{opacity:.7},children:"Paste persona overrides (JSON). These merge with base persona in config/slimy_ai.persona.json."}),(0,a.jsx)("textarea",{className:"textarea",value:d,onChange:e=>h(e.target.value)}),(0,a.jsx)("button",{className:"btn",style:{marginTop:20},onClick:g,children:"Save Personality"}),p&&(0,a.jsx)("p",{style:{marginTop:12},children:p}),(null==n?void 0:n.updatedAt)&&(0,a.jsxs)("p",{style:{marginTop:12,opacity:.7},children:["Last updated: ",new Date(n.updatedAt).toLocaleString()," by ",n.updatedBy||"unknown"]})]})})}}},function(e){e.O(0,[827,720,888,774,179],function(){return e(e.s=3617)}),_N_E=e.O()}]);