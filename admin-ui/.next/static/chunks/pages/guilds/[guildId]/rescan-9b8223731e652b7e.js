(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[787],{8990:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/guilds/[guildId]/rescan",function(){return n(7533)}])},4166:function(e,t,n){"use strict";n.d(t,{Z:function(){return d}});var a=n(4246),s=n(9894),l=n.n(s),i=n(6677),r=n(7378),o=n(6e3),c=n(5682);let u=[{href:e=>"/guilds/".concat(e),label:"Dashboard"},{href:e=>"/guilds/".concat(e,"/settings"),label:"Club Settings"},{href:e=>"/guilds/".concat(e,"/channels"),label:"Channels"},{href:e=>"/guilds/".concat(e,"/personality"),label:"Personality"},{href:e=>"/guilds/".concat(e,"/corrections"),label:"Corrections"},{href:e=>"/guilds/".concat(e,"/rescan"),label:"Rescan User"},{href:e=>"/guilds/".concat(e,"/usage"),label:"Usage"}];function d(e){var t;let{guildId:n,children:s,title:d}=e,h=(0,i.useRouter)(),p=(0,c.h)(),{user:m,refresh:g}=(0,o.k)(),f=(0,r.useMemo)(()=>n?u.map(e=>{let t=e.href(n);return{...e,href:t,active:h.pathname===t}}):[],[n,h.asPath]);return(0,a.jsxs)("div",{className:"layout",children:[(0,a.jsxs)("aside",{className:"sidebar",children:[(0,a.jsxs)("div",{style:{marginBottom:32},children:[(0,a.jsx)("h1",{style:{margin:0,fontSize:22,fontWeight:700},children:"Slimy Admin"}),m&&(0,a.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[(0,a.jsxs)("span",{style:{opacity:.8,fontSize:14},children:[m.username," \xb7 ",null===(t=m.role)||void 0===t?void 0:t.toUpperCase()]}),(0,a.jsx)("button",{className:"btn outline",onClick:async()=>{try{await p("/api/auth/logout",{method:"POST"}),await g()}catch(e){console.error(e)}},children:"Logout"})]})]}),n?(0,a.jsx)("nav",{style:{display:"flex",flexDirection:"column",gap:8},children:f.map(e=>(0,a.jsx)(l(),{href:e.href,legacyBehavior:!0,children:(0,a.jsx)("a",{style:{padding:"10px 12px",borderRadius:8,background:h.asPath===e.href?"rgba(56, 189, 248, 0.15)":"transparent",border:h.asPath===e.href?"1px solid rgba(56, 189, 248, 0.4)":"1px solid transparent"},children:e.label})},e.href))}):(0,a.jsx)("p",{style:{opacity:.7},children:"Select a guild to begin."})]}),(0,a.jsxs)("main",{className:"content",children:[d&&(0,a.jsx)("h2",{style:{marginTop:0,marginBottom:24},children:d}),s]})]})}},5682:function(e,t,n){"use strict";n.d(t,{S:function(){return l},h:function(){return i}});var a=n(7378),s=n(6e3);async function l(e){let{method:t="GET",body:n,csrfToken:a}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=new Headers;!n||n instanceof FormData||s.set("Content-Type","application/json"),a&&t&&"GET"!==t&&s.set("x-csrf-token",a);let l=await fetch("".concat("http://localhost:3080").concat(e),{method:t,body:n?n instanceof FormData?n:JSON.stringify(n):void 0,credentials:"include",headers:s});if(204===l.status)return null;let i=(l.headers.get("content-type")||"").includes("application/json")?await l.json():await l.text();if(!l.ok)throw Error((null==i?void 0:i.error)||(null==i?void 0:i.message)||"HTTP ".concat(l.status));return i}function i(){let{csrfToken:e}=(0,s.k)();return(0,a.useCallback)(function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return l(t,{...n,csrfToken:e})},[e])}},7533:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return o}});var a=n(4246),s=n(7378),l=n(6677),i=n(4166),r=n(5682);function o(){var e,t;let{guildId:n}=(0,l.useRouter)().query,o=(0,r.h)(),[c,u]=(0,s.useState)(null),[d,h]=(0,s.useState)(""),[p,m]=(0,s.useState)("auto"),[g,f]=(0,s.useState)(null),[x,y]=(0,s.useState)(null),b=async e=>{if(e.preventDefault(),!c||!d){y("File and member are required");return}let t=new FormData;t.append("file",c),t.append("member",d),t.append("metric",p),y("Uploading…");try{let e=await o("/api/guilds/".concat(n,"/rescan-user"),{method:"POST",body:t});f(e),y("Rescan complete")}catch(e){y(e.message)}};return(0,a.jsxs)(i.Z,{guildId:n,title:"Rescan Member Screenshot",children:[(0,a.jsxs)("form",{onSubmit:b,className:"card",style:{maxWidth:520,display:"grid",gap:16},children:[(0,a.jsx)("input",{type:"file",accept:"image/png,image/jpeg,image/webp",onChange:e=>{var t;return u((null===(t=e.target.files)||void 0===t?void 0:t[0])||null)}}),(0,a.jsx)("input",{className:"input",placeholder:"Display name",value:d,onChange:e=>h(e.target.value)}),(0,a.jsxs)("select",{className:"select",value:p,onChange:e=>m(e.target.value),children:[(0,a.jsx)("option",{value:"auto",children:"Auto"}),(0,a.jsx)("option",{value:"total",children:"Total"}),(0,a.jsx)("option",{value:"sim",children:"Sim"})]}),(0,a.jsx)("button",{className:"btn",type:"submit",children:"Upload & Parse"}),x&&(0,a.jsx)("p",{children:x})]}),g&&(0,a.jsxs)("div",{className:"card",style:{marginTop:24},children:[(0,a.jsx)("h4",{style:{marginTop:0},children:"Result"}),(0,a.jsxs)("p",{children:[g.displayName," → ",Number(g.value).toLocaleString()," (",g.metric,")"]}),(0,a.jsxs)("p",{style:{opacity:.7},children:["Ensemble disagreements: ",null===(e=g.ensemble)||void 0===e?void 0:e.disagreements," / ",null===(t=g.ensemble)||void 0===t?void 0:t.totalMembers]})]})]})}}},function(e){e.O(0,[827,888,774,179],function(){return e(e.s=8990)}),_N_E=e.O()}]);