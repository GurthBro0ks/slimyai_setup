(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[961],{3854:function(e,i,l){(window.__NEXT_P=window.__NEXT_P||[]).push(["/guilds",function(){return l(2851)}])},2851:function(e,i,l){"use strict";l.r(i),l.d(i,{default:function(){return c}});var t=l(5893),n=l(7294),r=l(1163),s=l(5754),d=l(2608),a=l(7751);function o(e){let{clientId:i,scopes:l,permissions:t="0",guildId:n,lockGuild:r=!1}=e,s=new URLSearchParams({client_id:i,scope:l,permissions:t});return n&&s.set("guild_id",n),r&&s.set("disable_guild_select","true"),"https://discord.com/oauth2/authorize?".concat(s.toString())}function c(){let e=(0,r.useRouter)(),{user:i,loading:l}=(0,d.k)(),[c,u]=(0,n.useState)([]),[g,h]=(0,n.useState)(!0),[p,m]=(0,n.useState)(null);(0,n.useEffect)(()=>{!l&&i&&(async()=>{try{let e=await (0,a.SC)("/api/guilds");u(e.guilds||[]),m(null)}catch(e){console.error("Failed to fetch guilds:",e),u([]),m(e.message||"Failed to load guilds")}finally{h(!1)}})()},[l,i]);let x={clientId:"1415387116564910161",scopes:"bot applications.commands",permissions:"274878286848"},y=o(x),f=i=>{if(!i)return;let l=i.id;"admin"===i.role?e.push("/guilds/".concat(l)):"club"===i.role?e.push("/club?guildId=".concat(l)):e.push("/snail/".concat(l))};return l||g?(0,t.jsx)(s.Z,{title:"Loading Guilds",children:(0,t.jsx)("div",{style:{textAlign:"center",padding:"2rem"},children:"Loading your guilds…"})}):i?p?(0,t.jsx)(s.Z,{title:"Error Loading Guilds",children:(0,t.jsx)("div",{className:"card",style:{padding:"2rem",maxWidth:600,margin:"0 auto"},children:(0,t.jsxs)("div",{style:{textAlign:"center",display:"grid",gap:"1.25rem"},children:[(0,t.jsx)("div",{style:{fontSize:"3rem"},children:"⚠️"}),(0,t.jsx)("h2",{style:{margin:0,color:"#f87171"},children:"Failed to Load Guilds"}),(0,t.jsx)("p",{style:{opacity:.8},children:p}),(0,t.jsxs)("div",{style:{display:"flex",gap:"0.75rem",justifyContent:"center"},children:[(0,t.jsx)("button",{className:"btn",onClick:()=>{m(null),h(!0),window.location.reload()},children:"Retry"}),(0,t.jsx)("a",{href:"/",className:"btn outline",children:"Go Home"})]})]})})}):0===c.length?(0,t.jsx)(s.Z,{title:"No Guilds Available",children:(0,t.jsxs)("div",{style:{textAlign:"center",padding:"2rem",display:"grid",gap:"1.25rem"},children:[(0,t.jsx)("div",{children:"No guilds available. Make sure you're in at least one Discord server."}),(0,t.jsx)("a",{href:y,target:"_blank",rel:"noopener noreferrer",style:{display:"inline-block",padding:"0.75rem 1.5rem",borderRadius:"8px",background:"linear-gradient(135deg, rgb(109,40,217), rgb(34,197,94))",color:"white",textDecoration:"none",fontWeight:600},children:"Add Bot to Server"})]})}):(0,t.jsxs)(s.Z,{title:"Select a Guild",children:[(0,t.jsx)("div",{style:{marginBottom:"1rem",display:"flex",justifyContent:"flex-end"},children:(0,t.jsx)("a",{href:y,target:"_blank",rel:"noopener noreferrer",style:{display:"inline-block",padding:"0.5rem 1rem",borderRadius:"8px",border:"1px solid rgba(56,189,248,0.3)",background:"rgba(56,189,248,0.1)",color:"rgb(56,189,248)",textDecoration:"none",fontSize:"0.875rem"},children:"+ Add Bot to Another Server"})}),(0,t.jsxs)("div",{className:"card",style:{padding:"1.5rem",display:"grid",gap:"1rem"},children:[(0,t.jsx)("h2",{style:{margin:0},children:"Choose a guild"}),(0,t.jsx)("p",{style:{opacity:.75},children:"Pick a server below. Access level is applied after selection."}),p&&(0,t.jsx)("div",{style:{color:"#f87171"},children:p}),(0,t.jsx)("div",{style:{display:"grid",gap:"1rem"},children:c.map(e=>{let i=!!e.installed,l=o({...x,guildId:e.id,lockGuild:!0});return(0,t.jsxs)("div",{className:"card",style:{padding:"1.25rem",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem"},children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{style:{fontWeight:600,fontSize:"1.05rem"},children:e.name}),(0,t.jsxs)("div",{style:{opacity:.7,fontSize:"0.85rem"},children:["Role: ",(e.role||"member").toUpperCase()]}),(0,t.jsx)("div",{style:{opacity:.6,fontSize:"0.8rem"},children:i?"Bot installed":"Bot not installed"})]}),(0,t.jsxs)("div",{style:{display:"flex",gap:"0.75rem",alignItems:"center"},children:[!i&&(0,t.jsx)("a",{href:l,target:"_blank",rel:"noopener noreferrer",style:{display:"inline-block",padding:"0.5rem 1rem",borderRadius:"8px",background:"linear-gradient(135deg, rgb(109,40,217), rgb(34,197,94))",color:"white",textDecoration:"none",fontSize:"0.85rem",fontWeight:600},children:"Invite Bot"}),(0,t.jsx)("button",{className:"btn",onClick:()=>f(e),children:"Open"})]})]},e.id)})})]})]}):(0,t.jsx)(s.Z,{title:"No Session",children:(0,t.jsx)("div",{style:{textAlign:"center",padding:"2rem"},children:"Please log in again."})})}}},function(e){e.O(0,[359,754,888,774,179],function(){return e(e.s=3854)}),_N_E=e.O()}]);